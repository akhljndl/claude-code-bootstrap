[
  {
    "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.go$\"",
    "hooks": [
      {
        "type": "command",
        "command": "node -e \"const{execFileSync}=require('child_process');const fs=require('fs');let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);const p=i.tool_input?.file_path;if(p&&fs.existsSync(p)){try{execFileSync('goimports',['-w',p],{stdio:['pipe','pipe','pipe'],env:{...process.env,PATH:process.env.HOME+'/go/bin:'+process.env.PATH}})}catch(e){}}console.log(d)})\""
      }
    ],
    "description": "Auto-format Go files with goimports after edits"
  },
  {
    "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.go$\"",
    "hooks": [
      {
        "type": "command",
        "command": "node -e \"const{execSync}=require('child_process');const fs=require('fs');const path=require('path');let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);const p=i.tool_input?.file_path;if(p&&fs.existsSync(p)){const dir=path.dirname(p);try{const r=execSync('go vet ./... 2>&1',{cwd:dir,encoding:'utf8',stdio:['pipe','pipe','pipe']});if(r.trim())console.error(r.trim())}catch(e){const out=(e.stdout||'')+(e.stderr||'');const lines=out.split('\\n').filter(l=>l.trim()).slice(0,10);if(lines.length)console.error('[Hook] go vet issues:\\n'+lines.join('\\n'))}}console.log(d)})\""
      }
    ],
    "description": "Run go vet after editing Go files"
  }
]
